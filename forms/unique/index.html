<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Parallel</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
</head>
<body>
    <div class="top-bar">
        <div class="top-top-bar">
            <div class="title">
                <h1>ADA Curb Ramp New Constriction Inspection Form (Unique Design)</h1>
            </div>
            <div class="print-button">
                <form id="fileNameForm">
                    <div class="downloadform">
                    <label for="fileName">File Name:</label>
                    <input type="text" id="fileName" name="fileName" placeholder="Enter file name"><br>
                    <button type="button" onclick="downloadCSV()">Download CSV</button>
                </div>
                </form>
            </div>
        </div>
        <form id="dataFormheader">
            <div class="header-group">
                <input type="text" id="ns-road" name="ns-road">
                <label for="ns-road">North-South Road Name</label>
            </div>
            <div class="header-group">
                <input type="text" id="proj-num" name="proj-num">
                <label for="proj-num">Project No.</label>
            </div>
            <div class="header-group">
                <input type="text" id="sheet-num" name="sheet-num">
                <label for="sheet-num">Sheet No.</label>
            </div>
            <div class="header-group">
                <input type="text" id="intersection" name="intersection">
                <label for="intersection">Intersection No.</label>
            </div>
            <div class="header-group">
                <input type="text" id="ew-road" name="ew-road">
                <label for="ew-road">East-West Road Name</label>
            </div>
            <div class="header-group">
                <input type="text" id="cal-date" name="cal-date">
                <label for="cal-date">Calibration Date</label>
            </div>
        </form>
    </div>
    <div class="container">
        <div class="column-side">
            <form id="dataForm1">
                <h2>Ramp Style: Unique Design</h2>
                <img src="../images/unique.png">
            </form>
            <div class="side-lower">
                <div>
                    <form>
                        <label for="warning2curb">Longest distance from detectable warning corner to back of curb (to nearest inch)</label>
                        <input type="number" id="warning2curb" name="warning2curb">
                    </form>
                </div>
                <div>
                    <label for="warning-fullwidth">Detectable warning extends full width of ramp throat opening</label>
                        <select id="warning-fullwidth" name="warning-fullwidth">
                            <option value="Y">Yes</option>
                            <option value="N">No</option>
                        </select>
                </div>

            </div>
            
        </div>
        <div class="column-mid">
            <div class="internal-column-container">
            <div class="internal-column">
                <form id="dataForm2">
                    <div class="middle-group">
                        <label for="runslope-1">Running Slope 1</label>
                        <input type="text" id="runslope-1" name="runslope-1">
                    </div>
                    <div class="middle-group">
                        <label for="length1">Length 1</label>
                        <input type="text" id="Length1" name="Length1">
                    </div>
                    <div class="middle-group">
                        <label for="cross-slope1">Cross Slope 1</label>
                        <input type="text" id="cross-slope1" name="cross-slope1">
                    </div>
                    <div class="middle-group">
                        <label for="detectable-warning">Detectable Warning</label>
                        <select id="detectable-warning" name="detectable-warning">
                            <option value="Y">Yes</option>
                            <option value="N">No</option>
                        </select>
                    </div>
                    <div class="middle-group">
                        <label for="lip-height">Lip Height</label>
                        <select id="lip-height" name="lip-height">
                            <option value="0">0</option>
                            <option value="0.5">0.5</option>
                            <option value="1">1.0</option>
                            <option value="2">2.0</option>
                            <option value="3">3.0</option>
                            <option value="4">4.0</option>
                        </select>
                    </div>
                    <div class="middle-group">
                        <label for="gutter-flow">Gutter Flow Slope</label>
                        <input type="number" id="gutter-flow" name="gutter-flow">
                    </div>
                    <div class="middle-group">
                        <label for="curb-slope">Curb Running Slope (avg)</label>
                        <input type="text" id="curb-slope" name="curb-slope">
                    </div>
                    <div class="middle-group">
                        <label for="counter-slope">Counter Slope (+/-) *2</label>
                        <input type="text" id="counter-slope" name="counter-slope">
                    </div>
                    <div class="middle-group">
                        <label for="dept-warning-width">Dept. warning full width of ramp</label>
                        <select id="dept-warning-width" name="dept-warning-width">
                            <option value="Y">Yes</option>
                            <option value="N">No</option>
                        </select>
                    </div>
                    <div class="middle-group">
                        <label for="runslope-2">Running Slope 2</label>
                        <input type="number" id="runslope-2" name="runslope-2">
                    </div>
                    <div class="middle-group">
                        <label for="length2">Length 2</label>
                        <input type="number" id="Length2" name="Length2">
                    </div>
                    <div class="middle-group">
                        <label for="cross-slope2">Cross Slope 2</label>
                        <input type="number" id="cross-slope2" name="cross-slope2">
                    </div>
                    <div class="middle-group">
                        <label for="runslope-3">Running Slope 3</label>
                        <input type="number" id="runslope-3" name="runslope-3">
                    </div>
                    <div class="middle-group">
                        <label for="length3">Length 3</label>
                        <input type="number" id="Length3" name="Length3">
                    </div>
                    <div class="middle-group">
                        <label for="cross-slope3">Cross Slope 3</label>
                        <input type="number" id="cross-slope3" name="cross-slope3">
                    </div>
                    <div class="middle-group">
                        <label for="widthx">Width X</label>
                        <input type="text" id="widthx" name="widthx">
                    </div>
                    <div class="middle-group">
                        <label for="Length Y">Length Y</label>
                        <input type="text" id="Length Y" name="Length Y">
                    </div>
                    <div class="middle-group">
                        <label for="obstruction">Back of Ramp Obstruction</label>
                        <select id="obstruction" name="obstruction">
                            <option value="Y">Yes</option>
                            <option value="N">No</option>
                        </select>
                    </div>
                    <div class="middle-group">
                        <label for="slopex">Slope X (Cross slope 1)</label>
                        <input type="text" id="slopex" name="slopex">
                    </div>
                    <div class="middle-group">
                        <label for="slopey">Slope Y (Running slope 1)</label>
                        <input type="text" id="slopey" name="slopey">
                    </div>
                    <div class="middle-group">
                        <label for="clear-width">Clear Width (feet)</label>
                        <input type="text" id="clear-width" name="clear-width">
                    </div>
                    <div class="middle-group">
                        <label for="intersection-control">Intersection Control Type</label>
                        <select id="intersection-control" name="intersection-control">
                            <option value="MB">MB</option>
                            <option value="SU">SU</option>
                            <option value="SY">SY</option>
                    </div>
                    <div class="middle-group">
                        <label for="horizontal-gaps">Horizontal Gaps</label>
                        <input type="text" id="horizontal-gaps" name="horizontal-gaps">
                    </div>
                </form>
            </div>
            <div class="internal-column">
                <form id="dataForm3">
                    <div class="middle-group2">
                        <label for="runslope-1">Running Slope 1</label>
                        <input type="text" id="runslope-1" name="runslope-1">
                    </div>
                    <div class="middle-group2">
                        <label for="length1">Length 1</label>
                        <input type="text" id="Length1" name="Length1">
                    </div>
                    <div class="middle-group2">
                        <label for="cross-slope1">Cross Slope 1</label>
                        <input type="text" id="cross-slope1" name="cross-slope1">
                    </div>
                    <div class="middle-group2">
                        <label for="detectable-warning">Detectable Warning</label>
                        <input type="text" id="detectable-warning" name="detectable-warning">
                    </div>
                    <div class="middle-group2">
                        <label for="lip-height">Lip Height</label>
                        <input type="text" id="lip-height" name="lip-height">
                    </div>
                    <div class="middle-group2">
                        <label for="gutter-flow">Gutter Flow Slope</label>
                        <input type="text" id="gutter-flow" name="gutter-flow">
                    </div>
                    <div class="middle-group2">
                        <label for="curb-slope">Curb Running Slope (avg)</label>
                        <input type="text" id="curb-slope" name="curb-slope">
                    </div>
                    <div class="middle-group2">
                        <label for="counter-slope">Counter Slope (+/-) *2</label>
                        <input type="text" id="counter-slope" name="counter-slope">
                    </div>
                    <form id="dataForm3">
                        <div class="middle-group2">
                            <label for="runslope-1">Running Slope 1</label>
                            <input type="text" id="runslope-1" name="runslope-1">
                        </div>
                        <div class="middle-group2">
                            <label for="length1">Length 1</label>
                            <input type="text" id="Length1" name="Length1">
                        </div>
                        <div class="middle-group2">
                            <label for="cross-slope1">Cross Slope 1</label>
                            <input type="text" id="cross-slope1" name="cross-slope1">
                        </div>
                        <div class="middle-group2">
                            <label for="detectable-warning">Detectable Warning</label>
                            <input type="text" id="detectable-warning" name="detectable-warning">
                        </div>
                        <div class="middle-group2">
                            <label for="lip-height">Lip Height</label>
                            <input type="text" id="lip-height" name="lip-height">
                        </div>
                        <div class="middle-group2">
                            <label for="gutter-flow">Gutter Flow Slope</label>
                            <input type="text" id="gutter-flow" name="gutter-flow">
                        </div>
                        <div class="middle-group2">
                            <label for="curb-slope">Curb Running Slope (avg)</label>
                            <input type="text" id="curb-slope" name="curb-slope">
                        </div>
                        <div class="middle-group2">
                            <label for="counter-slope">Counter Slope (+/-) *2</label>
                            <input type="text" id="counter-slope" name="counter-slope">
                        </div>
                        <div class="middle-group2">
                            <label for="detectable-warning">Detectable Warning</label>
                            <input type="text" id="detectable-warning" name="detectable-warning">
                        </div>
                        <div class="middle-group2">
                            <label for="lip-height">Lip Height</label>
                            <input type="text" id="lip-height" name="lip-height">
                        </div>
                        <div class="middle-group2">
                            <label for="gutter-flow">Gutter Flow Slope</label>
                            <input type="text" id="gutter-flow" name="gutter-flow">
                        </div>
                        <div class="middle-group2">
                            <label for="curb-slope">Curb Running Slope (avg)</label>
                            <input type="text" id="curb-slope" name="curb-slope">
                        </div>
                        <div class="middle-group2">
                            <label for="counter-slope">Counter Slope (+/-) *2</label>
                            <input type="text" id="counter-slope" name="counter-slope">
                        </div>
                </form>
            </div>
        </div>
    </div>
    <div class="column-side">
        <div class="vertbox-container">
        <div class="vertbox">
            <div class="internal-column-container">
            <div class="internal-column2">
                <form id="dataForm4">
                    <input type="text" id="corner-position" name="corner-position"><br>
                    <label for="corner-position">Corner Position</label>
                    <input type="text" id="ramp-position" name="ramp-position"><br>
                    <label for="ramp-position">Ramp Position</label>
                </form>
    </div>
        <div class="internal-column3">
            <img src="../images/intersection.png">
        </div>
    </div>
        </div>
        <div class="vertbox">
            <form id="dataForm5">
                <div class="comments-box">
                    <label for="comments">Comments</label>
                    <input type="text" id="comments" name="comments"><br>
                </div>
            </form>
        </div>
        <div class="vertbox">
            <div class="internal-column-container">
            <div class="internal-column3">
                <form id="signatures-form">
                    <input type="text" id="inspector-sig" name="inspector-sig"><br>
                    <label for="inspector-sig">Inspector's Signature</label>
                    <input type="text" id="print-name" name="print-name"><br>
                    <label for="print-name">Print name clearly</label>
                    <input type="text" id="agency" name="agency"><br>
                    <label for="agency">Company/Agency</label>
                </form>
            </div>
            <div class="internal-column2">
                <form id="signatures-dates">
                    <input type="text" id="inspection-date" name="inspection-date"><br>
                    <label for="inspection-date">Inspection date</label>
                    <input type="text" id="certification" name="certification"><br>
                    <label for="certification">Certification No.</label>
                    <input type="text" id="blank" name="blank"><br>
                    <label for="blank">  </label>
                </form>
            </div>
        </div>
    </div>
    </div>
</div>
</div>
<script>
    function downloadXLSX() {
        const inputs = document.querySelectorAll('input[type="text"], input[type="number"], select');
        const data = [];

        // Collect headers
        const headers = [];
        inputs.forEach(input => {
            headers.push(input.name);
        });
        data.push(headers);

        // Collect values
        const values = [];
        inputs.forEach(input => {
            values.push(input.value);
        });
        data.push(values);

        // Convert data to worksheet and then to XLSX
        const worksheet = XLSX.utils.aoa_to_sheet(data);
        const workbook = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(workbook, worksheet, 'Sheet1');
        const xlsxData = XLSX.write(workbook, { bookType: 'xlsx', type: 'array' });
        const blob = new Blob([xlsxData], { type: 'application/octet-stream' });

        // Get file name from input
        const fileName = document.getElementById('fileName').value || 'data';

        // Create download link
        const link = document.createElement('a');
        link.href = URL.createObjectURL(blob);
        link.download = `${fileName}.xlsx`;
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
    }
</script>
</body>
</html>
